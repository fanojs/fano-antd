{"version":3,"sources":["../../../src/FanoForm/types/imgbox.jsx"],"names":["FanoFormImgBox","props","state","previewVisible","previewImage","handlePreview","bind","handleCancel","handleRemove","handleChange","setState","file","url","thumbUrl","console","log","fileList","onChange","field","injectProps","allowPreview","allowRemove","allowUpload","uploadButton","showUploadList","showPreviewIcon","showRemoveIcon","styles","container","value","length","label","width","React","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAKqBA,c;;;AACnB,4BAAaC,KAAb,EAAoB;AAAA;;AAAA,wJACZA,KADY;;AAElB,YAAKC,KAAL,GAAa;AACXC,wBAAgB,KADL;AAEXC,sBAAc;AAFH,OAAb;AAIA,YAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,OAArB;AACA,YAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBD,IAAlB,OAApB;AACA,YAAKE,YAAL,GAAoB,MAAKA,YAAL,CAAkBF,IAAlB,OAApB;AACA,YAAKG,YAAL,GAAoB,MAAKA,YAAL,CAAkBH,IAAlB,OAApB;AATkB;AAUnB;;;;qCAEe;AACd,aAAKI,QAAL,CAAc,EAAEP,gBAAgB,KAAlB,EAAd;AACD;;;oCAEcQ,I,EAAM;AACnB,aAAKD,QAAL,CAAc;AACZN,wBAAcO,KAAKC,GAAL,IAAYD,KAAKE,QADnB;AAEZV,0BAAgB;AAFJ,SAAd;AAID;;;mCAEaQ,I,EAAM;AAClBG,gBAAQC,GAAR,CAAYJ,IAAZ;AACD;;;yCAEiC;AAAA,YAAlBA,IAAkB,QAAlBA,IAAkB;AAAA,YAAZK,QAAY,QAAZA,QAAY;;AAChCF,gBAAQC,GAAR,CAAYJ,IAAZ,EAAkBK,QAAlB;AACA,aAAKf,KAAL,CAAWgB,QAAX,CAAoBD,QAApB;AACD;;;+BAES;AAAA,YACAE,KADA,GACU,KAAKjB,KAAL,CAAWkB,WADrB,CACAD,KADA;;AAER,YAAMjB,QAAQ,oBAAS,KAAKA,KAAd,EAAqB,CACjC,UADiC,EAEjC,MAFiC,EAGjC,QAHiC,EAIjC,UAJiC,EAKjC,iBALiC,EAMjC,SANiC,EAOjC,QAPiC,EAQjC,MARiC,EASjC,eATiC,CAArB,CAAd;AAFQ,2BAa2CiB,MAAMjB,KAbjD;AAAA,YAaAmB,YAbA,gBAaAA,YAbA;AAAA,YAacC,WAbd,gBAacA,WAbd;AAAA,YAa2BC,WAb3B,gBAa2BA,WAb3B;AAAA,qBAeiC,KAAKpB,KAftC;AAAA,YAeAC,cAfA,UAeAA,cAfA;AAAA,YAegBC,YAfhB,UAegBA,YAfhB;;AAgBR,YAAImB,eACF;AAAA;AAAA;AACE,0DAAM,MAAM,MAAZ,GADF;AAEE;AAAA;AAAA,cAAK,WAAW,iBAAhB;AAAA;AAAA;AAFF,SADF;AAMAtB,cAAMuB,cAAN,GAAuB,EAAvB;AACA,YAAIJ,iBAAiB,KAArB,EAA4B;AAC1BnB,gBAAMuB,cAAN,CAAqBC,eAArB,GAAuC,KAAvC;AACD;AACD,YAAIJ,gBAAgB,KAApB,EAA2B;AACzBpB,gBAAMuB,cAAN,CAAqBE,cAArB,GAAsC,KAAtC;AACD;AACD,YAAIJ,gBAAgB,KAApB,EAA2B;AACzBC,yBAAe,IAAf;AACD;AACD,eACE;AAAA;AAAA,YAAK,gBAAcI,iBAAOC,SAA1B;AACE;AAAA;AAAA,uCACM3B,KADN;AAEE,wBAAU,cAFZ;AAGE,wBAAU,KAAKA,KAAL,CAAW4B,KAAX,IAAoB,EAHhC;AAIE,yBAAW,KAAKxB,aAJlB;AAKE,wBAAU,KAAKG,YALjB;AAME,wBAAU,KAAKC;AANjB;AAQG,iBAAKR,KAAL,CAAW4B,KAAX,CAAiBC,MAAjB,IAA2B,CAA3B,GAA+B,IAA/B,GAAsCP;AARzC,WADF;AAWE;AAAA;AAAA;AACE,uBAASpB,cADX;AAEE,sBAAQ,IAFV;AAGE,wBAAU,KAAKI;AAHjB;AAKE;AACE,mBAAKW,MAAMa,KADb;AAEE,qBAAO,EAAEC,OAAO,MAAT,EAFT;AAGE,mBAAK5B;AAHP;AALF;AAXF,SADF;AAyBD;;;IA1FyC6B,gBAAMC,S;;oBAA7BlC,c","file":"imgbox.js","sourcesContent":["import React from 'react'\nimport { Upload, Icon, Modal } from 'antd'\nimport { getProps } from '../../utils/form'\nimport styles from './imgbox.less'\n\nexport default class FanoFormImgBox extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      previewVisible: false,\n      previewImage: null\n    }\n    this.handlePreview = this.handlePreview.bind(this)\n    this.handleCancel = this.handleCancel.bind(this)\n    this.handleRemove = this.handleRemove.bind(this)\n    this.handleChange = this.handleChange.bind(this)\n  }\n\n  handleCancel () {\n    this.setState({ previewVisible: false })\n  }\n\n  handlePreview (file) {\n    this.setState({\n      previewImage: file.url || file.thumbUrl,\n      previewVisible: true\n    })\n  }\n\n  handleRemove (file) {\n    console.log(file)\n  }\n\n  handleChange ({ file, fileList }) {\n    console.log(file, fileList)\n    this.props.onChange(fileList)\n  }\n\n  render () {\n    const { field } = this.props.injectProps\n    const props = getProps(this.props, [\n      'disabled',\n      'name',\n      'action',\n      'multiple',\n      'withCredentials',\n      'headers',\n      'accept',\n      'data',\n      'customRequest'\n    ])\n    const { allowPreview, allowRemove, allowUpload } = field.props\n\n    const { previewVisible, previewImage } = this.state\n    let uploadButton = (\n      <div>\n        <Icon type={'plus'} />\n        <div className={'ant-upload-text'}>Upload</div>\n      </div>\n    )\n    props.showUploadList = {}\n    if (allowPreview === false) {\n      props.showUploadList.showPreviewIcon = false\n    }\n    if (allowRemove === false) {\n      props.showUploadList.showRemoveIcon = false\n    }\n    if (allowUpload === false) {\n      uploadButton = null\n    }\n    return (\n      <div className={`${styles.container}`}>\n        <Upload\n          {...props}\n          listType={'picture-card'}\n          fileList={this.props.value || []}\n          onPreview={this.handlePreview}\n          onRemove={this.handleRemove}\n          onChange={this.handleChange}\n        >\n          {this.props.value.length >= 3 ? null : uploadButton}\n        </Upload>\n        <Modal\n          visible={previewVisible}\n          footer={null}\n          onCancel={this.handleCancel}\n        >\n          <img\n            alt={field.label}\n            style={{ width: '100%' }}\n            src={previewImage}\n          />\n        </Modal>\n      </div>\n    )\n  }\n}\n"]}